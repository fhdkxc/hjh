package kr.or.ddit.common.controller;

import java.util.List;

import javax.servlet.http.HttpServletRequest;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import kr.or.ddit.common.service.CommonService;
import kr.or.ddit.common.service.HeaderService;
import kr.or.ddit.util.etc.AuthManager;
import kr.or.ddit.vo.ClasVO;
import kr.or.ddit.vo.MemberVO;
import lombok.extern.slf4j.Slf4j;

@Slf4j
@Controller
public class HeaderController {
	@Autowired
	CommonService commonService;
	
	@Autowired
	AuthManager authManager;
	
	@ResponseBody
	@PostMapping("/goToClass")
	public List<ClasVO> goToClass(HttpServletRequest request) {
		// 로그인한 회원 ID
		MemberVO memberVO = (MemberVO) request.getSession().getAttribute("USER_INFO");
		String mberId = memberVO.getMberId();
		// 로그인한 회원의 회원분류
		String auth = authManager.get1Auth(memberVO);

		List<ClasVO> clasVO = commonService.myClassList(mberId, auth);
		log.info("memberVO : "+memberVO);
		log.info("clasVO : "+clasVO);
		
		return clasVO;
	}
}
