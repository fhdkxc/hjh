<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<script type="text/javascript" src="/resources/js/jquery.min.js"></script>
<script type="text/javascript">
//beforeSend 전역변수 처리
const header="${_csrf.headerName}";
const token ="${_csrf.token}";
const mberId = "${param.mberId}";

console.log("mberId : ",mberId);

window.onload = function(){
	console.log("실행되었습니다~ ")
	
	//날짜 포맷 생성  함수
	function dateFormat(date) {
		let dateFormat2 = date.getFullYear() +
		'-' + ( (date.getMonth()+1) < 9 ? "0" + (date.getMonth()+1) : (date.getMonth()+1) )+
		'-' + ( (date.getDate()) < 9 ? "0" + (date.getDate()) : (date.getDate()) );
		return dateFormat2;
	}
	
	// 선생님이 등록한 방과후학교 목록 불러오기
	let data = {
		"mberId" : mberId	
	};
	console.log("data : ", data);
	
	// 선생님이 등록한 방과후학교 목록 불러오는 ajax
	$.ajax({
		url: "/afterSchool/afterSchoolTeacherList",
		contentType: "application/json ; charset=utf-8",
		data: data,
		type: "get",
		dataType: "json",
		beforeSend : function(xhr){
			xhr.setRequestHeader(header, token);
		},
		success:function(result){
			console.log("result : ", result);
			let str = "";
			result.forEach(function(aschaVO, idx){
				let aschaAtnlcBgnde = dateFormat(new Date(aschaVO.aschaAtnlcBgnde));
				let aschaAtnlcEndde = dateFormat(new Date(aschaVO.aschaAtnlcEndde));
				
				str += `
					<tr>
					<td>\${idx+1}</td>
					<td>\${aschaVO.aschaNm}</td>
					<td>\${aschaVO.aschaAceptncPsncpa}</td>
					<td>\${aschaAtnlcBgnde}</td>
					<td>\${aschaAtnlcEndde}</td>
					<td>\${aschaVO.cmmnAtnlcNm}</td>
					</tr>					
				`
			});
			console.log("str : ", str);
			document.querySelector("#teacherListBody").innerHTML = str;
			
		}
	});

	
}


</script>

<style>
.content {
	display: flex;
	justify-content: center;
	align-items: center;
}

.single-product-text {
	padding: 5px;
}

.overflow-scroll {
	height: 700px;
	overflow-y: auto; /* 세로 스크롤 설정 */
}

.class-container {
    width: 800px;
    margin: 8px;
    height: 800px;
    border: 1px solid lightgray;
    border-radius: 5px;
    background-color: white;
}

</style>
<div class="analytics-sparkle-area">
	${param.mberId}의 방과후교실~

	<div class="container-fluid ">
		<div class="row content">
			<div class="class-container">
				<div
					class="courses-inner res-mg-t-30 table-mg-t-pro-n tb-sm-res-d-n dk-res-t-d-n">
					<div class="courses-title">
						<h2>나의 방과후 개설 목록</h2>
						<hr>
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"
							style="padding: 0px;">
							<div class="product-status-wrap drp-lst overflow-scroll"
								style="padding: 0px;">
								<table>
									<thead>
										<tr>
											<th>번호</th>
											<th>방과후학교 명</th>
											<th>수용정원(명)</th>
											<th>수강시작일자</th>
											<th>수강종료일자</th>
											<th>상태</th>
										</tr>
									</thead>
									<tbody id="teacherListBody">
										<!-- 여기에 테이블 내용 추가 -->
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
			
			
			<!-- 학생목록 띄우기 -->
			<div class="class-container">
				<div
					class="courses-inner res-mg-t-30 table-mg-t-pro-n tb-sm-res-d-n dk-res-t-d-n">
					<div class="courses-title">
						<div>
							<h2>수강신청한 학생 목록</h2>
							<hr>
						</div>
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"
							style="padding: 0px;">
							<div class="product-status-wrap drp-lst overflow-scroll"
								style="padding: 0px;">
								<table>
									<tbody>
										<tr>
											<th>번호</th>
											<th>학년</th>
											<th>반</th>
											<th>번호</th>
											<th>이름</th>
											<th>상태</th>
										</tr>
										<tr>
											<td>1</td>
											<td>Computer</td>
											<td>John Alva</td>
											<td>admin@gmail.com</td>
											<td>01962067309</td>
											<td>1500</td>
										</tr>
										<tr>
											<td>2</td>
											<td>Mechanical</td>
											<td>John Alva</td>
											<td>admin@gmail.com</td>
											<td>01962067309</td>
											<td>1700</td>
										</tr>
										<tr>
											<td>3</td>
											<td>MBA</td>
											<td>John Alva</td>
											<td>admin@gmail.com</td>
											<td>01962067309</td>
											<td>1500</td>
										</tr>
										<tr>
											<td>4</td>
											<td>BBA</td>
											<td>John Alva</td>
											<td>admin@gmail.com</td>
											<td>01962067309</td>
											<td>1200</td>
										</tr>
										<tr>
											<td>5</td>
											<td>BBA</td>
											<td>John Alva</td>
											<td>admin@gmail.com</td>
											<td>01962067309</td>
											<td>1200</td>
										</tr>
										<tr>
											<td>6</td>
											<td>BBA</td>
											<td>John Alva</td>
											<td>admin@gmail.com</td>
											<td>01962067309</td>
											<td>1200</td>
										</tr>
										<tr>
											<td>6</td>
											<td>BBA</td>
											<td>John Alva</td>
											<td>admin@gmail.com</td>
											<td>01962067309</td>
											<td>1200</td>
										</tr>
										<!-- 여기에 테이블 내용 추가 -->
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
</div>

