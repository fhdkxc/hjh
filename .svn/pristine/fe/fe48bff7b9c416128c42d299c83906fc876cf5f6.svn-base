<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<style>
#ntcnTitle h3{
font-size: 2.2rem;
text-align: center;
backdrop-filter: blur(4px);
background-color: rgba(255, 255, 255, 1);
border-radius: 50px;
box-shadow: 35px 35px 68px 0px rgba(145, 192, 255, 0.5), inset -8px -8px 16px 0px rgba(145, 192, 255, 0.6), inset 0px 11px 28px 0px rgb(255, 255, 255);
width: 370px;
padding-top: 35px;
padding-bottom: 35px;
margin: auto;
margin-bottom: 40px;
}
</style>
<style>
#ntcnSj{
	width:95%;
	border:none;
	background: none;
	height: 50px;
	font-size: 1.4rem;
	display: inline-block;
	vertical-align: middle;
	margin-bottom:6px;
}

#ntcnTitle{
	min-height: 255px;
}

#ntcnContainer{
	min-height: 255px;
}

#ntcnContainer .custom-pagination{
	max-width:302px;
	margin: auto;
}
#ntcnContainer .custom-pagination .pagination {
	 width: max-content;
}
.searchForm{
	height: 40px;
	border: 1px solid #ddd;
	border-radius: 5px;
	padding: 15px 20px;
}

#searchBtn,#insertBtn{
	background: #333;
	height: 40px;
	border: none;
	padding: 10px 15px;
	border-radius: 10px;
	font-family: 'Pretendard' !important;
	font-weight: 600;
	color: #fff;
}
#searchBtn:hover, #insertBtn:hover{
	background: #ffd77a;
	color:#333;
	transition:all 1s;
	font-weight: 700;
}
#insertBtn{
	background: #006DF0;
}

#searchCondition{
	height: 40px;
	border: 1px solid #ddd;
	border-radius: 5px;
	padding-left: 10px;
}

.custom-datatable-overright table tbody tr.none-tr td:hover{
	background: #fff!imporant;
}

.ntcnAll{
	width: 1400px;
	margin: auto;
	backdrop-filter: blur(10px);
	background-color: rgba(255, 255, 255, 1);
	border-radius: 50px;
	box-shadow: 0px 35px 68px 0px rgba(145, 192, 255, 0.5), inset 0px -6px 16px 0px rgba(145, 192, 255, 0.6), inset 0px 11px 28px 0px rgb(255, 255, 255);
	padding: 50px 80px;
	margin-bottom:50px;
	min-height:530px;"
}

.ntcnAll .ntcn-cont{
	border: 1px solid #ddd;
	border-radius: 10px;
	padding: 10px 20px;
	min-height: 83px;
	margin-top: 20px;
}
.ntcnAll .ntcnTit {
	display: flex;
	justify-content: space-between;
	position:relative;
}

.ntcnAll .title{
	font-size: 1.8rem;
	font-weight: 700;
	margin-top: 6px;

}
.ntcnInfo {
	display: flex;
	justify-content: space-between;
	margin-top: 10px;
	padding-left: 10px;
	font-size: 1rem;
}

#ntcnArea{
	resize: none;
	height: auto;
	border: none;
}
</style>
<script type="text/javascript" src="/resources/js/commonFunction.js"></script>
<script type="text/javascript" src="/resources/js/jquery.min.js"></script>
<script type="text/javascript">
//전역 변수
var currentPage = "${param.currentPage}";
var keyword = "";
var clasCode = "${clasCode}";

if(currentPage == "") currentPage = "1";

var data = {
	"clasCode":clasCode,
	"currentPage":currentPage,	
	"keyword":keyword
};

$(function(){
	// 알림장 목록 불러오기
	$.ajax({
		url:"/ntcn/ntcnList",
		contentType:"application/json;charset=utf-8",
		data:JSON.stringify(data),
		type:"post",
		dataType:"json",
		beforeSend:function(xhr){
			xhr.setRequestHeader("${_csrf.headerName}","${_csrf.token}");
		},
		success: function(res){
// 			alert("리스트 불러오기 성공~");
			console.log("ntcnList", res);
			
			var str = "";
			
			$.each(res, function(idx, ntcnVO){
				str += "<div class='ntcnAll'><div><div class='ntcnTit'>";
				str += "<input type='text' class='form-control input-sm' name='ntcnSj' id='ntcnSj' value='"+ntcnVO.ntcnSj+"' readonly>";
				str += "<img src='/resources/images/classRoom/freeBrd/line.png' style='position: absolute;left: 0px;top: 10px;z-index: -1;'>";
				str += "</div><div class='ntcnInfo'>";
				str += "<span>작성자: "+ntcnVO.hrtchrVO.mberNm+"</span>";
				str += "<span>작성일: "+dateFormat(ntcnVO.ntcnWritngDt)+"</span>";
				str += "<span>조회수: "+ntcnVO.ntcnCnt+"</span>";
				str += "</div></div>";
				str += "<div class='form-group res-mg-t-15'>";
				str += "<div class='ntcn-cont'>";
				str += "<div id='smarteditor'>";
				str += "<div id='ntcnCn' style='width:100%;' style='border:1px solid #ddd;'>";
				str += "<textarea id='ntcnArea' name='ntcnArea' readonly>"+ntcnVO.ntcnCn+"</textarea>";
				str += "<img alt='알림장 이미지' src='/resources/images/classRoom/notice/박명수.JPG'>";
				str += "</div></div></div></div></div>";
				
			});
			
			$("#ntcnContainer").html(str);
		}
	});
	
	// 알림 등록
	$("#insertBtn").on("click", function(){
		location.href = "/ntcn/ntcnInsertForm?clasCode="+clasCode;
	});
})
</script>
<div id="ntcnTitle">
	<form id="freefrm" method="post" action="/freeBoard/freeBoardDetailView">
		<input type="hidden" value="" id="nttCode" name="nttCode">
		<sec:csrfInput />
	</form>
	<div class="sparkline13-list">
		<h3>
			<img src="/resources/images/classRoom/notice/noticeContent.png" style="width:50px; margin-bottom: 5px; display:inline-block; vertical-align:middel;">
				알림장
			<img src="/resources/images/classRoom/notice/star.png" style="width:40px; margin-bottom: 10px; display:inline-block; vertical-align:middel;">		
		</h3>
		<div class="sparkline13-graph">
			<div class="datatable-dashv1-list custom-datatable-overright">
				<div class="bootstrap-table">
					<div class="fixed-table-toolbar">
						<div class="pull-left button">
							<button type="button" id="insertBtn">알림 등록</button>
						</div>
						<div class="pull-right search" style="margin-bottom: 20px;">
							<form action="/freeBoard/freeBoardList" method="get">
								<!-- 검색 조건 시작-->
								<select name="searchCondition" id="searchCondition">
<%-- 								방법1)<option value="" <c:if test="${searchCondition eq ''}">selected="selected"</c:if>>전체</option> --%>
<%-- 									<option value="titl" <c:if test="${searchCondition eq 'titl'}">selected="selected"</c:if>>제목</option> --%>
<%-- 									<option value="cntn" <c:if test="${searchCondition eq 'cntn'}">selected="selected"</c:if>>내용</option> --%>
<%-- 									<option value="titlCntn" <c:if test="${searchCondition eq 'titlCntn'}">selected="selected"</c:if>>제목 + 내용</option> --%>
<%-- 									<option value="writ" <c:if test="${searchCondition eq 'writ'}">selected="selected"</c:if>>작성자</option> --%>
<!-- 								방법2) -->
									<option value="">전체</option>
									<!-- db쿼리단에서 value값으로 if문 쓰기위해  조건마다 value값 입력 -->
									<option value="titl">제목</option>
									<option value="cntn">내용</option>
									<option value="titlCntn">제목 + 내용</option>
									<option value="writ">작성자</option>
								</select>
								<!-- 검색 조건 끝-->
								<!-- 검색어 시작 -->
								<input class="searchForm" type="text" placeholder="" id="keyword" name="keyword" value="">
								<button type="submit" id="searchBtn">검색</button>
								<!-- 검색어 끝 -->
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div id="ntcnContainer">
	<div class="ntcnAll">
		<div>
			<div class="ntcnTit">
				<input type="text" class="form-control input-sm" name="ntcnSj" id="ntcnSj" value="현장체험학습 안내" readonly>
            <img src="/resources/images/classRoom/freeBrd/line.png" style="position: absolute;left: 0px;top: 10px;z-index: -1;">
			</div>
			<div class="ntcnInfo">
	            <span>
	               	작성자: 담임
	            </span>
	            <span>
	              	작성일자: 2023-12-12
	            </span>
	            <span>
	              	조회수: 123
	            </span>
			</div>
		</div>
		<div class="form-group res-mg-t-15">
			<div class="ntcn-cont">
         ​​​​​​​​		<div id="smarteditor">
         			<div id="ntcnCn" style="width:100%;" style="border:1px solid #ddd;">
			            <textarea id="ntcnArea" name="ntcnArea" readonly>ㅇㅇ</textarea>
		        		<img alt="알림장 이미지" src="/resources/images/classRoom/notice/박명수.JPG">
		            </div>
         		</div>
         	</div>
        </div>
	</div>
</div>